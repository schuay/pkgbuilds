#Contributor Antti Oja <antti.bofh(AT)gmail.com>
#Contributor Jakob Gruber <jakob.gruber(AT)kabelnet.at>
pkgname=rt2870
pkgver=2.4.0.0
pkgrel=1
pkgdesc="Drivers for rt2870 chipset wireless cards"
arch=('i686' 'x86_64')
url="http://eng.ralinktech.com.tw/support.php?s=2"
depends=('kernel26' 'kernel26-headers')
license="GPL"
install=install.rt2870
source=('http://dl.dropbox.com/u/169548/2010_06_25_RT2870_Linux_STA_v2.4.0.0.tar.bz2')
md5sums=('9ab5d68566eb6defd5a794bb98bcf425')

build() {

  cd $srcdir/2010_06_25_RT2870_Linux_STA_v2.4.0.0

  #configure for being controlled by NetworkManager or wpa_supplicant wext functions

  sed "s#HAS_WPA_SUPPLICANT=n#HAS_WPA_SUPPLICANT=y#" -i os/linux/config.mk
  sed "s#HAS_NATIVE_WPA_SUPPLICANT_SUPPORT=n#HAS_NATIVE_WPA_SUPPLICANT_SUPPORT=y#" -i os/linux/config.mk
  
  make

  install -D -m 755 os/linux/rt2870sta.ko $pkgdir/lib/modules/$(uname -r)/kernel/drivers/net/wireless/rt2870sta.ko
  install -D -m 644 RT2870STA.dat $pkgdir/etc/Wireless/RT2870STA/RT2870STA.dat
}
