# Maintainer: schuay <jakob.gruber@gmail.com>

pkgname=eiffelstudio
pkgver=7.2
pkgrel=1
pkgdesc='A complete integrated Eiffel software development environment'
arch=('i686' 'x86_64')
url='http://eiffel.com/products/studio/'
license=('GPL')
depends=('gtk2' 'libxtst')

# Unfortunately, the tarball is hidden behind a login.
# Download it manually from the product site, and place it
# into the same directory as the PKGBUILD before calling makepkg.

source=('Eiffel72_gpl_91351-linux-x86-64.tar.bz2')
_platform="linux-x86-64"
md5sums=('9d35cb6e305bdc336a0a803bd6af2027')

if [ "$CARCH" == "i686" ]; then
    source=('Eiffel72_gpl_91351-linux-x86.tar.bz2')
    _platform="linux-x86"
    md5sums=('a92129322b94a8fb48830c12fa872df5')
fi

package() {
    mkdir -p "${pkgdir}/opt"
    mv "${srcdir}/Eiffel72" "${pkgdir}/opt/"

    mkdir -p "${pkgdir}/usr/bin"
    echo "#!/bin/bash" >> "${pkgdir}/usr/bin/eiffelstudio"
    echo "export ISE_EIFFEL=/opt/Eiffel72" >> "${pkgdir}/usr/bin/eiffelstudio"
    echo "export ISE_PLATFORM=${_platform}" >> "${pkgdir}/usr/bin/eiffelstudio"
    echo "export PATH=\"$PATH:${ISE_EIFFEL}/studio/spec/${ISE_PLATFORM}/bin\"" >> "${pkgdir}/usr/bin/eiffelstudio"
    echo "estudio $@" >> "${pkgdir}/usr/bin/eiffelstudio"
    chmod 755 "${pkgdir}/usr/bin/eiffelstudio"
}

